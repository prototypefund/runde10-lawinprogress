<!DOCTYPE html>
<html lang="en">
<head>
    <title>Law In Progress</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/imgs/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/imgs/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/imgs/favicon-16x16.png">
    <link rel="manifest" href="/imgs/site.webmanifest">
</head>
<body>
  <section class="hero is-primary is-small">
    <!--HEADER-->
    <div class="hero-head">
      <nav class="navbar">
        <div class="container">
          <div class="navbar-brand">
            <a class="navbar-item">
              <img src="imgs/lip_logo.png" alt="Law in Progress Logo">
            </a>
            <span class="navbar-burger" data-target="navbarMenuHeroA">
              <span></span>
              <span></span>
              <span></span>
            </span>
          </div>
          <div id="navbarMenuHeroA" class="navbar-menu">
            <div class="navbar-end">
              <span class="navbar-item">
              <div class="buttons">
                <a class="button is-primary is-light" href="mailto: bug@lawinprogress.de">
                  <strong>Report a bug</strong>
                </a>
                <a class="button is-light" href="https://gitlab.com/nototast/lawinprogress" target="_blank">
                  Source code
                </a>
              </div>
              </span>
            </div>
          </div>
        </div>
      </nav>
    <div class="hero-body">
      <!--Info bar-->
      <div class="container is-fluid">
        <nav class="level">
          <!-- Left side -->
          <div class="level-left">
            <div class="level-item">
              <p class="subtitle is-5">
                Änderungen aus {{ name }}
              </p>
            </div>
          </div>
        
          <!-- Right side -->
          <div class="level-right"></div>
        </nav>
      </div>
      <!--Select law-->
      <div class="box container is-fluid">
        <nav class="level">
          <!-- Left side -->
          <div class="level-left">
            <div class="level-item">
                <strong>betroffenes Gesetz auswählen</strong>:
            </div>
            <div class="level-item">
              <div class="field has-addons">
                <div class="dropdown is-active" onclick="this.classList.toggle('is-active')">
                  <div class="dropdown-trigger">
                    <button class="button is-primary is-light" aria-haspopup="true" aria-controls="dropdown-menu">
                      <span id="active-law">{{ result[0][0] }}</span>
                      <span class="icon is-small">
                        <i class="fas fa-angle-down" aria-hidden="true"></i>
                      </span>
                    </button>
                  </div>
                  <div class="dropdown-menu" id="dropdown-menu" role="menu">
                    <div class="dropdown-content">
                      {% for law_title, proposal_text in result %}
                        <a class="dropdown-item tablinks" onclick="openLaw(event, '{{ law_title }}')" id="defaultOpen">{{ law_title }}</a>
                      {% endfor %}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Right side -->
          <div class="level-right">
            <p class="level-item"><strong>27 Änderungen</strong></p>
            <p class="level-item is-success is-light">22 Angewandt</p>
            <p class="level-item">5 nicht zuortbar</p>
          </div>
        </nav>
      </div>

      <!--Column selector-->
      <div class="container is-fluid">
        <nav class="level">
          <!-- Left side-->
          <div class="level-right">
          </div>
        
          <!-- Right side -->
          <div class="level-right">
            <p class="level-item">
              <label class="checkbox">
                <input type="checkbox" checked="checked" id="check_old" onclick="toggleColumn('old')">
                Alte Fassung
              </label>
            </p>
            <p class="level-item">
              <label class="checkbox">
                <input type="checkbox" id="check_change" onclick="toggleColumn('change')">
                Änderungsbefehl
              </label>
            </p>
            <p class="level-item">
              <label class="checkbox">
                <input type="checkbox" checked="checked" id="check_new" onclick="toggleColumn('new')">
                Neue Fassung
              </label>
            </p>
          </div>
        </nav>
      </div>
    </div>
  </section>
  <section class="section">
    <div class="container is-fluid">
    <!--Diff part-->
    {% for law_title, proposal_texts in result %}
      <div id="{{ law_title }}" class="tabcontent">
        <div class="field is-grouped">
          <button class="button is-fullwidth" onclick="scrolldiv('back', '{{ law_title }}')">&laquo;</button>
          <button class="button is-fullwidth" onclick="scrolldiv('top', '{{ law_title }}')">Nach oben</button>
          <button class="button is-fullwidth" onclick="scrolldiv('forward', '{{ law_title }}')">&raquo;</button>
        </div>
        <div class="scrollable">
          <h2 class="title" id="{{ law_title }}law-title"><center>{{ law_title}}</center></h2>
          <div class="diff-layout" style="grid-template-columns: auto auto auto;">
            <article class="message old">
              <div class="message-header">
                Alte Fassung
              </div>
            </article>
            <article class="message change">
              <div class="message-header">
                Änderungsbefehl
              </div>
            </article>
            <article class="message new">
              <div class="message-header">
                Neue Fassung
              </div>
            </article>
            {% for line in proposal_texts %}
              {{ line[0]|safe }}
              {{ line[1]|safe }}
              {{ line[2]|safe }}
            {% endfor %}
          </div>
          </div>
        </div>
      </div>
    {% endfor %}
    </div>
  </section>

<script>
// manage the tab content
function openLaw(evt, lawTitle) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(lawTitle).style.display = "block";
  evt.currentTarget.className += " active";

  // change the active law in dropdown
  document.getElementById("active-law").innerHTML = lawTitle;
}

// Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();
</script>
<script>
// up and down buttons
let num = 0;

function scrolldiv(direction, lawTitle) {
  if (direction === "top"){
    var elem = document.getElementById(lawTitle + "law-title");
    elem.scrollIntoView();
    num = 0;
  }
  if (num < 0) {
    num = 0;
  }
  try {
    if (direction === "forward"){
      var elem = document.getElementById(lawTitle + "change-" + num);
      elem.scrollIntoView();
      num += 1;
    }
    if (direction === "back" && num > 0){
      var elem = document.getElementById(lawTitle + "change-" + num);
      elem.scrollIntoView();
      num -= 1;
    }
  }
  catch {
    num -= 1;
  }
}
</script>
<script>
  // handle the hidding of columns with checkboxes
  function toggleColumn(column) {
    // Get the checkbox
    var checkBox = document.getElementById("check_"+column);
    // Get the column elements
    column_elem = document.getElementsByClassName(column);
    grid_clmn = document.getElementsByClassName("diff-layout")[0];

    // If the checkbox is checked, display the output text
    if (checkBox.checked == true){
      for (i = 0; i < column_elem.length; i++) {
        column_elem[i].style.display = "block";
      }
      grid_clmn.style.gridTemplateColumns = grid_clmn.style.gridTemplateColumns + " auto";
    } else {
      for (i = 0; i < column_elem.length; i++) {
        column_elem[i].style.display = "none";
      }
      grid_clmn.style.gridTemplateColumns = grid_clmn.style.gridTemplateColumns.slice(0, grid_clmn.style.gridTemplateColumns.length - 5);
    }
  }
  toggleColumn("change")
</script>
</body>
</html> 
